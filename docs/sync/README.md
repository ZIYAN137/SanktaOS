# 同步机制概览

同步原语用于在多核/可抢占内核中协调并发访问，避免数据竞争与状态破坏。

## 设计要点

- **SMP 并发**：禁用本地中断只能避免“任务 vs 本地中断”的并发，不能阻止其他 CPU 并行访问；跨核共享数据需要自旋锁/原子等机制。
- **中断上下文限制**：中断处理应尽量短小，避免阻塞/睡眠/复杂路径；耗时工作建议下放到任务上下文执行。
- **死锁预防**：需要多把锁时遵循统一的锁顺序（lock ordering），避免循环等待。

详见：[同步机制设计要点](./design.md)

## 代码位置（以 rustdoc 为准）

- `crates/sync/src/`：通用同步原语（SpinLock/RwLock/TicketLock/IntrGuard/PreemptGuard 等）
- `os/src/sync/`：与内核运行时强相关的封装（如 `PerCpu`、内核互斥等）

